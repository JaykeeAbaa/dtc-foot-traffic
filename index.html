<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DICT - Digital Transformation Center Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom scrollbar for clean look */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #e4e4e7; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #d4d4d8; }

        /* Confirmation Page Animations */
        @keyframes checkmark-draw {
            0% {
                stroke-dashoffset: 100;
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes scale-in-bounce {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.15);
            }
            70% {
                transform: scale(0.95);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.5;
            }
            100% {
                transform: scale(1.4);
                opacity: 0;
            }
        }

        @keyframes fade-in-up {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fade-in {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        .confirmation-icon {
            position: relative;
            animation: scale-in-bounce 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .confirmation-icon::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(16, 185, 129, 0.2);
            animation: pulse-ring 1.5s ease-out 0.3s forwards;
        }

        .confirmation-icon svg {
            position: relative;
            z-index: 1;
        }

        .confirmation-icon svg path {
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: checkmark-draw 0.9s ease-out 0.4s forwards;
        }

        .confirmation-title {
            animation: fade-in-up 0.5s ease-out 0.4s both;
        }

        .confirmation-subtitle {
            animation: fade-in-up 0.5s ease-out 0.5s both;
        }

        .confirmation-summary {
            animation: fade-in-up 0.5s ease-out 0.6s both;
        }

        .confirmation-button {
            animation: fade-in-up 0.5s ease-out 0.7s both;
        }
    </style>
</head>
<body class="bg-zinc-50 text-zinc-900 antialiased selection:bg-blue-100 selection:text-blue-900 h-screen overflow-hidden flex flex-col">

    <!-- Top Navigation Bar -->
    <header class="w-full bg-white border-b border-zinc-200 sticky top-0 z-50 shrink-0">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="logo.png" alt="DICT logo" class="h-9 w-9 object-contain">
                <div>
                    <h1 class="text-sm font-semibold tracking-tight leading-none text-zinc-900">DICT <span class="text-zinc-400 font-normal">|</span> DTC Surigao del Sur Office</h1>
                    <p class="text-[10px] uppercase tracking-wider text-zinc-500 font-medium pt-0.5">Digital Transformation Center</p>
                </div>
            </div>
            <div class="flex items-center gap-4 text-zinc-400">
                <a href="https://www.facebook.com/DICTCaraga/" target="_blank" rel="noopener noreferrer" class="hover:text-zinc-600 transition-colors" title="Visit DICT Caraga Facebook Page">
                    <span class="iconify" data-icon="lucide:help-circle" data-width="20" data-stroke-width="1.5"></span>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto w-full">
        <div class="max-w-[480px] mx-auto py-6 px-6">
            
            <!-- Form Section -->
            <div id="formSection">
                <!-- Form Header -->
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold tracking-tight text-zinc-900">DTC Foot Traffic System</h2>
                    <p class="text-sm text-zinc-500 mt-1">Please fill in your details to enter the center.</p>
                </div>

                <!-- Form -->
                <form id="registrationForm" class="space-y-5">
                
                <!-- Name Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">Name</label>
                    <div class="relative group">
                        <span class="absolute left-3 top-2.5 text-zinc-400 group-focus-within:text-blue-600 transition-colors">
                            <span class="iconify" data-icon="lucide:user" data-width="18" data-stroke-width="1.5"></span>
                        </span>
                        <input type="text" id="name" name="name" placeholder="Juan Dela Cruz" required class="w-full pl-10 pr-4 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all placeholder:text-zinc-400">
                    </div>
                </div>

                <!-- City/Municipality Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">City/Municipality</label>
                    <div class="relative group">
                        <span class="absolute left-3 top-2.5 text-zinc-400 group-focus-within:text-blue-600 transition-colors">
                            <span class="iconify" data-icon="lucide:map-pin" data-width="18" data-stroke-width="1.5"></span>
                        </span>
                        <input type="text" id="cityMunicipality" name="cityMunicipality" placeholder="Tandag City" required class="w-full pl-10 pr-4 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all placeholder:text-zinc-400">
                    </div>
                </div>

                <!-- Barangay Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">Barangay</label>
                    <div class="relative group">
                        <span class="absolute left-3 top-2.5 text-zinc-400 group-focus-within:text-blue-600 transition-colors">
                            <span class="iconify" data-icon="lucide:map" data-width="18" data-stroke-width="1.5"></span>
                        </span>
                        <input type="text" id="barangay" name="barangay" placeholder="Barangay Name" required class="w-full pl-10 pr-4 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all placeholder:text-zinc-400">
                    </div>
                </div>

                <!-- Gender Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">Gender</label>
                    <div class="relative">
                        <select id="gender" name="gender" required class="w-full pl-3 pr-8 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all appearance-none text-zinc-700 cursor-pointer">
                            <option value="">Select...</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Prefer not to say">Prefer not to say</option>
                        </select>
                        <span class="absolute right-3 top-2.5 text-zinc-400 pointer-events-none">
                            <span class="iconify" data-icon="lucide:chevron-down" data-width="16" data-stroke-width="1.5"></span>
                        </span>
                    </div>
                </div>

                <!-- Age Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">Age</label>
                    <div class="relative group">
                        <span class="absolute left-3 top-2.5 text-zinc-400 group-focus-within:text-blue-600 transition-colors">
                            <span class="iconify" data-icon="lucide:calendar" data-width="18" data-stroke-width="1.5"></span>
                        </span>
                        <input type="number" id="age" name="age" placeholder="25" min="1" max="120" required class="w-full pl-10 pr-4 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all placeholder:text-zinc-400">
                    </div>
                </div>

                <!-- Sector Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">Sector</label>
                    <div class="relative">
                        <select id="sector" name="sector" required class="w-full pl-3 pr-8 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all appearance-none text-zinc-700 cursor-pointer">
                            <option value="">Select...</option>
                            <option value="Out of School Youth & Adult">Out of School Youth & Adult</option>
                            <option value="Educator">Educator</option>
                            <option value="Student">Student</option>
                            <option value="PWDs">PWD's</option>
                            <option value="Women">Women</option>
                            <option value="Senior Citizen">Senior Citizen</option>
                            <option value="OFW">OFW</option>
                            <option value="Entrepreneur">Entrepreneur</option>
                            <option value="Indigenous People">Indigenous People</option>
                            <option value="Farmers and Fisherfolks">Farmers and Fisherfolks</option>
                            <option value="Government Employee">Government Employee</option>
                            <option value="Other">Other</option>
                        </select>
                        <span class="absolute right-3 top-2.5 text-zinc-400 pointer-events-none">
                            <span class="iconify" data-icon="lucide:chevron-down" data-width="16" data-stroke-width="1.5"></span>
                        </span>
                    </div>
                </div>

                <!-- Service/Purpose Field -->
                <div>
                    <label class="block text-[11px] uppercase tracking-wider font-semibold text-zinc-500 mb-1.5">Service/Purpose</label>
                    <div class="space-y-2">
                        <div class="relative">
                            <select id="servicePurpose" name="servicePurpose" required class="w-full pl-3 pr-8 py-2 text-sm bg-zinc-50 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all appearance-none text-zinc-700 cursor-pointer">
                                <option value="">Select...</option>
                                <option value="Training">Training</option>
                                <option value="Inquiry">Inquiry</option>
                                <option value="Meeting">Meeting</option>
                                <option value="Co-working">Co-working</option>
                                <option value="Gov Application">Gov Application</option>
                                <option value="Other">Other (please specify)</option>
                            </select>
                            <span class="absolute right-3 top-2.5 text-zinc-400 pointer-events-none">
                                <span class="iconify" data-icon="lucide:chevron-down" data-width="16" data-stroke-width="1.5"></span>
                            </span>
                        </div>
                        <div id="servicePurposeOtherWrapper" class="hidden">
                            <input type="text" id="servicePurposeOther" name="servicePurposeOther" placeholder="Please specify other service/purpose" class="w-full px-3 py-2 text-sm bg-zinc-50 border border-dashed border-zinc-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:border-zinc-300 transition-all placeholder:text-zinc-400">
                        </div>
                    </div>
                </div>

                <!-- Data Privacy -->
                <div class="bg-blue-50/50 border border-blue-100 rounded-lg p-3 flex items-start gap-3">
                    <div class="relative flex items-center mt-0.5">
                        <input type="checkbox" id="consent" name="consent" required class="peer h-4 w-4 cursor-pointer appearance-none rounded border border-zinc-300 checked:bg-blue-600 checked:border-blue-600 transition-all">
                        <span class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-white opacity-0 peer-checked:opacity-100 pointer-events-none">
                            <span class="iconify" data-icon="lucide:check" data-width="12"></span>
                        </span>
                    </div>
                    <label for="consent" class="text-xs text-zinc-600 leading-relaxed cursor-pointer select-none">
                        I consent to the processing of my personal data in accordance with the <span class="font-medium text-blue-700 hover:underline">Data Privacy Act of 2012</span> for contact tracing and analytics purposes.
                    </label>
                </div>

                <!-- Success/Error Messages -->
                <div id="messageContainer" class="hidden"></div>

                <!-- Submit Button -->
                <div>
                    <button type="submit" id="submitBtn" class="group w-full bg-zinc-900 hover:bg-zinc-800 text-white font-medium py-2.5 text-sm rounded-lg shadow-lg shadow-zinc-900/10 flex items-center justify-center gap-2 transition-all active:scale-[0.99] disabled:opacity-50 disabled:cursor-not-allowed">
                        <span id="submitText">Complete Registration</span>
                        <span id="submitIcon" class="group-hover:translate-x-1 transition-transform">
                            <span class="iconify" data-icon="lucide:arrow-right" data-width="18" data-stroke-width="1.5"></span>
                        </span>
                    </button>
                    <p class="text-center text-[10px] text-zinc-400 mt-3 flex items-center justify-center gap-1">
                        <span class="iconify" data-icon="lucide:shield-check" data-width="12" data-stroke-width="1.5"></span>
                        Secure &amp; Encrypted Submission
                    </p>
                </div>
                </form>
            </div>

            <!-- Confirmation Page Section -->
            <div id="confirmationSection" class="hidden">
                <div class="text-center mb-6">
                    <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-emerald-100 mb-4 confirmation-icon">
                        <svg class="w-10 h-10 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h2 class="text-2xl font-semibold tracking-tight text-zinc-900 mb-2 confirmation-title">Registration Successful!</h2>
                    <p class="text-sm text-zinc-500 confirmation-subtitle">Thank you for checking in to the Digital Transformation Center.</p>
                </div>

                <!-- Submitted Information Summary -->
                <div class="bg-zinc-50 border border-zinc-200 rounded-lg p-5 space-y-4 mb-6 confirmation-summary">
                    <h3 class="text-xs uppercase tracking-wider font-semibold text-zinc-500 mb-3">Registration Details</h3>
                    
                    <div class="space-y-3">
                        <div class="flex items-start gap-3">
                            <span class="text-zinc-400 mt-0.5">
                                <span class="iconify" data-icon="lucide:user" data-width="16" data-stroke-width="1.5"></span>
                            </span>
                            <div class="flex-1">
                                <p class="text-[10px] uppercase tracking-wider font-semibold text-zinc-500">Name</p>
                                <p class="text-sm text-zinc-900 mt-0.5" id="confirmName">-</p>
                            </div>
                        </div>

                        <div class="flex items-start gap-3">
                            <span class="text-zinc-400 mt-0.5">
                                <span class="iconify" data-icon="lucide:map-pin" data-width="16" data-stroke-width="1.5"></span>
                            </span>
                            <div class="flex-1">
                                <p class="text-[10px] uppercase tracking-wider font-semibold text-zinc-500">Location</p>
                                <p class="text-sm text-zinc-900 mt-0.5" id="confirmLocation">-</p>
                            </div>
                        </div>

                        <div class="flex items-start gap-3">
                            <span class="text-zinc-400 mt-0.5">
                                <span class="iconify" data-icon="lucide:building-2" data-width="16" data-stroke-width="1.5"></span>
                            </span>
                            <div class="flex-1">
                                <p class="text-[10px] uppercase tracking-wider font-semibold text-zinc-500">Sector</p>
                                <p class="text-sm text-zinc-900 mt-0.5" id="confirmSector">-</p>
                            </div>
                        </div>

                        <div class="flex items-start gap-3">
                            <span class="text-zinc-400 mt-0.5">
                                <span class="iconify" data-icon="lucide:briefcase" data-width="16" data-stroke-width="1.5"></span>
                            </span>
                            <div class="flex-1">
                                <p class="text-[10px] uppercase tracking-wider font-semibold text-zinc-500">Service/Purpose</p>
                                <p class="text-sm text-zinc-900 mt-0.5" id="confirmPurpose">-</p>
                            </div>
                        </div>

                        <div class="flex items-start gap-3">
                            <span class="text-zinc-400 mt-0.5">
                                <span class="iconify" data-icon="lucide:calendar" data-width="16" data-stroke-width="1.5"></span>
                            </span>
                            <div class="flex-1">
                                <p class="text-[10px] uppercase tracking-wider font-semibold text-zinc-500">Date & Time</p>
                                <p class="text-sm text-zinc-900 mt-0.5" id="confirmDateTime">-</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="space-y-3 confirmation-button">
                    <button type="button" id="registerAnotherBtn" class="group w-full bg-zinc-900 hover:bg-zinc-800 text-white font-medium py-2.5 text-sm rounded-lg shadow-lg shadow-zinc-900/10 flex items-center justify-center gap-2 transition-all active:scale-[0.99]">
                        <span class="iconify" data-icon="lucide:user-plus" data-width="18" data-stroke-width="1.5"></span>
                        <span>Register Another Visitor</span>
                    </button>
                    <p class="text-center text-[10px] text-zinc-400 flex items-center justify-center gap-1">
                        <span class="iconify" data-icon="lucide:shield-check" data-width="12" data-stroke-width="1.5"></span>
                        Your information has been securely submitted
                    </p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // IMPORTANT: Replace this URL with your Google Apps Script Web App URL
        // You'll get this URL after deploying your Google Apps Script (see instructions in Code.gs)
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxUwM9sr3Eccxl9V_5wV2JT9XU9-KGmVnxkRh5ZVQp8XaTC4YRKfFFkP6L7xmyaCos/exec';

        const form = document.getElementById('registrationForm');
        const formSection = document.getElementById('formSection');
        const confirmationSection = document.getElementById('confirmationSection');
        const submitBtn = document.getElementById('submitBtn');
        const submitText = document.getElementById('submitText');
        const submitIcon = document.getElementById('submitIcon');
        const messageContainer = document.getElementById('messageContainer');
        const registerAnotherBtn = document.getElementById('registerAnotherBtn');

        // Confirmation page elements
        const confirmName = document.getElementById('confirmName');
        const confirmLocation = document.getElementById('confirmLocation');
        const confirmSector = document.getElementById('confirmSector');
        const confirmPurpose = document.getElementById('confirmPurpose');
        const confirmDateTime = document.getElementById('confirmDateTime');

        function showMessage(message, isError = false) {
            messageContainer.className = `p-4 rounded-lg ${isError ? 'bg-red-50 border border-red-200 text-red-700' : 'bg-emerald-50 border border-emerald-200 text-emerald-700'}`;
            messageContainer.innerHTML = `
                <div class="flex items-center gap-2">
                    <span class="iconify" data-icon="${isError ? 'lucide:alert-circle' : 'lucide:check-circle'}" data-width="18"></span>
                    <span class="text-sm font-medium">${message}</span>
                </div>
            `;
            messageContainer.classList.remove('hidden');
            
            // Scroll to message
            messageContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            // Hide message after 5 seconds for success, keep error visible
            if (!isError) {
                setTimeout(() => {
                    messageContainer.classList.add('hidden');
                }, 5000);
            }
        }

        function showConfirmationPage(formData) {
            // Populate confirmation page with submitted data
            confirmName.textContent = formData.name;
            confirmLocation.textContent = `${formData.barangay}, ${formData.cityMunicipality}`;
            confirmSector.textContent = formData.sector;
            confirmPurpose.textContent = formData.servicePurpose;
            
            // Format date and time
            const now = new Date();
            const dateTime = now.toLocaleString('en-US', {
                month: 'long',
                day: 'numeric',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            confirmDateTime.textContent = dateTime;

            // Hide form and show confirmation
            formSection.classList.add('hidden');
            confirmationSection.classList.remove('hidden');
            
            // Reset and trigger animations by forcing reflow
            const icon = confirmationSection.querySelector('.confirmation-icon');
            const title = confirmationSection.querySelector('.confirmation-title');
            const subtitle = confirmationSection.querySelector('.confirmation-subtitle');
            const summary = confirmationSection.querySelector('.confirmation-summary');
            const button = confirmationSection.querySelector('.confirmation-button');
            
            // Remove and re-add animation classes to restart animations
            [icon, title, subtitle, summary, button].forEach(el => {
                if (el) {
                    el.style.animation = 'none';
                    void el.offsetHeight; // Trigger reflow
                    el.style.animation = null;
                }
            });
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showForm() {
            // Hide confirmation and show form
            confirmationSection.classList.add('hidden');
            formSection.classList.remove('hidden');
            
            // Reset form
            form.reset();
            document.getElementById('consent').checked = false;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Register another visitor button handler
        registerAnotherBtn.addEventListener('click', () => {
            showForm();
        });

        // Handle service/purpose "Other" option
        const servicePurposeSelect = document.getElementById('servicePurpose');
        const servicePurposeOtherWrapper = document.getElementById('servicePurposeOtherWrapper');
        const servicePurposeOtherInput = document.getElementById('servicePurposeOther');

        servicePurposeSelect.addEventListener('change', () => {
            if (servicePurposeSelect.value === 'Other') {
                servicePurposeOtherWrapper.classList.remove('hidden');
                servicePurposeOtherInput.focus();
            } else {
                servicePurposeOtherWrapper.classList.add('hidden');
                servicePurposeOtherInput.value = '';
            }
        });

        function setLoading(isLoading) {
            submitBtn.disabled = isLoading;
            if (isLoading) {
                submitText.textContent = 'Submitting...';
                submitIcon.innerHTML = '<span class="iconify" data-icon="lucide:loader-2" data-width="18" data-stroke-width="1.5" class="animate-spin"></span>';
            } else {
                submitText.textContent = 'Check In Now';
                submitIcon.innerHTML = '<span class="iconify" data-icon="lucide:arrow-right" data-width="18" data-stroke-width="1.5"></span>';
            }
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Check if Google Script URL is configured
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                showMessage('Please configure the Google Script URL in the code. See setup instructions.', true);
                return;
            }

            // Validate consent checkbox
            const consent = document.getElementById('consent').checked;
            if (!consent) {
                showMessage('Please provide consent to proceed.', true);
                return;
            }

            // Collect form data
            const selectedServicePurpose = document.getElementById('servicePurpose').value;
            const servicePurposeOther = servicePurposeOtherInput.value.trim();

            const formData = {
                name: document.getElementById('name').value.trim(),
                cityMunicipality: document.getElementById('cityMunicipality').value.trim(),
                barangay: document.getElementById('barangay').value.trim(),
                sector: document.getElementById('sector').value,
                servicePurpose: selectedServicePurpose === 'Other' ? servicePurposeOther : selectedServicePurpose,
                gender: document.getElementById('gender').value,
                age: document.getElementById('age').value,
                timestamp: new Date().toISOString()
            };

            // Validate all fields
            if (!formData.name || !formData.cityMunicipality || !formData.barangay || !formData.sector || !selectedServicePurpose || !formData.gender || !formData.age || (selectedServicePurpose === 'Other' && !servicePurposeOther)) {
                showMessage('Please fill in all required fields.', true);
                return;
            }

            setLoading(true);
            messageContainer.classList.add('hidden');

            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Google Apps Script requires no-cors
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                // With no-cors mode, we can't read the response, so we'll assume success
                // The Google Script will handle the actual submission
                // Show confirmation page instead of message
                showConfirmationPage(formData);

            } catch (error) {
                console.error('Error:', error);
                showMessage('There was an error submitting your registration. Please try again.', true);
            } finally {
                setLoading(false);
            }
        });
    </script>

</body></html>
